{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"h2\", null, \"个人信息修改\", -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $setup.backToPreviousPage && $setup.backToPreviousPage(...args))\n  }, \"返回\"), _hoisted_1, _createVNode(_component_el_form, {\n    ref: \"form\",\n    model: $setup.form,\n    \"label-width\": \"120px\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_form_item, {\n      label: \"用户名\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        modelValue: $setup.form.username,\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.form.username = $event)\n      }, null, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, {\n      label: \"密码\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        modelValue: $setup.form.password,\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.form.password = $event),\n        type: \"password\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, {\n      label: \"邮箱\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        modelValue: $setup.form.email,\n        \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.form.email = $event)\n      }, null, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, {\n      label: \"个性签名\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        modelValue: $setup.form.signature,\n        \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.form.signature = $event)\n      }, null, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, null, {\n      default: _withCtx(() => [_createVNode(_component_el_button, {\n        type: \"primary\",\n        onClick: _cache[5] || (_cache[5] = $event => $setup.submitForm('form'))\n      }, {\n        default: _withCtx(() => [_createTextVNode(\"提交\")]),\n        _: 1 /* STABLE */\n      })]),\n\n      _: 1 /* STABLE */\n    })]),\n\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"model\"])]);\n}","map":{"version":3,"names":["_createElementVNode","_createElementBlock","onClick","_cache","args","$setup","backToPreviousPage","_hoisted_1","_createVNode","_component_el_form","ref","model","form","_component_el_form_item","label","_component_el_input","username","$event","password","type","email","signature","_component_el_button","submitForm"],"sources":["/Users/lynneu/Documents/GitHub/IM-web/im-frontend/src/views/userInfo.vue"],"sourcesContent":["<template>\n    <div>\n      <button @click=\"backToPreviousPage\">返回</button>\n      <h2>个人信息修改</h2>\n      <el-form ref=\"form\" :model=\"form\" label-width=\"120px\">\n        <el-form-item label=\"用户名\">\n          <el-input v-model=\"form.username\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"密码\">\n          <el-input v-model=\"form.password\" type=\"password\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"邮箱\">\n          <el-input v-model=\"form.email\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"个性签名\">\n          <el-input v-model=\"form.signature\"></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"submitForm('form')\">提交</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n  </template>\n  \n  <script>\n  import { ref } from 'vue';\n  import { useStore } from 'vuex';\n  import { ElMessage } from 'element-plus';\n  \n  export default {\n    name: 'userInfo',\n    setup() {\n      const store = useStore();\n      const form = ref({\n        username: store.state.user.username,\n        password: '',\n        email: store.state.user.email,\n        signature: ''\n      });\n  \n      const backToPreviousPage = () => {\n        // TODO: 返回上一界面的逻辑\n      };\n  \n      const submitForm = async (formName) => {\n        const formData = form.value;\n        // TODO: 调用后端的更新用户接口，传递formData，并处理返回的数据\n        try {\n          const response = await fetch(`/users/${store.state.user.id}`, {\n            method: 'PUT',\n            headers: {\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify(formData),\n          });\n          if (!response.ok) throw new Error('Network response was not ok');\n          const result = await response.json();\n  \n          if (result.username === formData.username && result.email === formData.email) {\n            ElMessage.success('个人信息修改成功');\n            // TODO: 更新Vuex中的用户状态\n            store.commit('updateUser', result);\n          } else {\n            ElMessage.error('个人信息修改失败');\n          }\n        } catch (error) {\n          console.error('Error:', error);\n          ElMessage.error('服务器出现问题，请稍后再试');\n        }\n      };\n  \n      return { backToPreviousPage, form, submitForm };\n    },\n  };\n  </script>\n  "],"mappings":";gCAGMA,mBAAA,CAAe,YAAX,QAAM;;;;;;;uBAFZC,mBAAA,CAoBM,cAnBJD,mBAAA,CAA+C;IAAtCE,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,MAAA,CAAAC,kBAAA,IAAAD,MAAA,CAAAC,kBAAA,IAAAF,IAAA,CAAkB;KAAE,IAAE,GACtCG,UAAe,EACfC,YAAA,CAgBUC,kBAAA;IAhBDC,GAAG,EAAC,MAAM;IAAEC,KAAK,EAAEN,MAAA,CAAAO,IAAI;IAAE,aAAW,EAAC;;sBAC5C,MAEe,CAFfJ,YAAA,CAEeK,uBAAA;MAFDC,KAAK,EAAC;IAAK;wBACvB,MAA6C,CAA7CN,YAAA,CAA6CO,mBAAA;oBAA1BV,MAAA,CAAAO,IAAI,CAACI,QAAQ;mEAAbX,MAAA,CAAAO,IAAI,CAACI,QAAQ,GAAAC,MAAA;;;QAElCT,YAAA,CAEeK,uBAAA;MAFDC,KAAK,EAAC;IAAI;wBACtB,MAA6D,CAA7DN,YAAA,CAA6DO,mBAAA;oBAA1CV,MAAA,CAAAO,IAAI,CAACM,QAAQ;mEAAbb,MAAA,CAAAO,IAAI,CAACM,QAAQ,GAAAD,MAAA;QAAEE,IAAI,EAAC;;;QAEzCX,YAAA,CAEeK,uBAAA;MAFDC,KAAK,EAAC;IAAI;wBACtB,MAA0C,CAA1CN,YAAA,CAA0CO,mBAAA;oBAAvBV,MAAA,CAAAO,IAAI,CAACQ,KAAK;mEAAVf,MAAA,CAAAO,IAAI,CAACQ,KAAK,GAAAH,MAAA;;;QAE/BT,YAAA,CAEeK,uBAAA;MAFDC,KAAK,EAAC;IAAM;wBACxB,MAA8C,CAA9CN,YAAA,CAA8CO,mBAAA;oBAA3BV,MAAA,CAAAO,IAAI,CAACS,SAAS;mEAAdhB,MAAA,CAAAO,IAAI,CAACS,SAAS,GAAAJ,MAAA;;;QAEnCT,YAAA,CAEeK,uBAAA;wBADb,MAAoE,CAApEL,YAAA,CAAoEc,oBAAA;QAAzDH,IAAI,EAAC,SAAS;QAAEjB,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAc,MAAA,IAAEZ,MAAA,CAAAkB,UAAU;;0BAAU,MAAE,C,iBAAF,IAAE,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}